---
layout: page
title: "(DataSource) Տվյալների աղբյուրի ընդլայնում"
tags: [Extender, DSEXTENDER]
---


## Բովանդակություն
* [Նախաբան](#նախաբան)
  * [.as ընդլայնմամբ ֆայլի սահմանում](#as-ընդլայնմամբ-ֆայլի-սահմանում)
  * [Extender դաս](#extender-դաս)
    * [Հատկություններ](#հատկություններ)
    * [Մեթոդներ](#մեթոդներ)

## Նախաբան

Գոյություն ունեցող տվյալների աղբյուրում լրացուցիչ սյուներ, պարամետրեր ավելացնելու, տողերի պարունակությունը փոփոխելու համար նկարագրվում է տվյալների աղբյուրի ընդլայնում։

8X համակարգում տվյալների աղբյուրի ընդլայնում նկարագրելու համար հարկավոր է ունենալ
-   .as ընդլայնմամբ ֆայլ սկրիպտերում, որը պարունակում է մետատվյալներ ընդլայնման մասին,
-   .cs ընդլայնմամբ ֆայլ, որը պարունակում է սերվերում աշխատող տրամաբանությունը։

## .as ընդլայնմամբ ֆայլի սահմանում

Տվյալների աղբյուրի ընդլայման համար անհրաժեշտ է ստեղծել .as ընդլայնմամբ ֆայլ՝ ավելացնելով DSEXTENDER տիպի նկարագրություն , որը պարունակում է տվյալների աղբյուրի ընդլայման՝
    -  NAME - ներքին անվանումը,
    -  CAPTION - հայերեն անվանումը՝  `ANSI`  կոդավորմամբ,
    -  ECAPTION - անգլերեն անվանումը,
    -  DATASOURCE - ընդլայնվող տվյալների աղբյուրի ներքին անվանումը,
    -  CSSOURCE - սերվերում աշխատող տրամաբանությունը պարունակող  .cs ընդլայնմամբ ֆայլի հարաբերական ճանապարհը .as ընդլայնմամբ ֆայլի նկատմամբ։
-   Ստեղծված ֆայլը ներմուծել տվյալների բազա  `Syscon`  գործիքով։

## Extender դաս

```c#
public abstract class Extender<R, P> : IExtender
    where P : class, new()
    where R : class, new()
```

Տվյալների աղբյուրի ընդլայման համար անհրաժեշտ է սահմանել դաս, որը ժառանգում է Extender<R, P> դասը՝ -   որպես R փոխանցելով տվյալների աղբյուրի ընդլայման սյուները նկարագրող դասը, իսկ որպես P՝ պարամետրերը նկարագրող դասը։ Եթե տվյալների աղբյուրը ընդլայնումը չի պարունակում պարամետրեր, ապա որպես P անհրաժեշտ է փոխանցել  `NoParam`  դասը։

Նկարագրման օրինակին ծանոթանալու համար [տե՛ս](..\examples\ds.md)։

## Հատկություններ

### AlwaysCallBeforeProcess

[BeforeProcess](#beforeProcess) մեթոդը կանչվում է միայն այն դեպքում, երբ տվյալների աղբյուրը պարունակում է տողեր։ Տողեր չպարունակելու դեպքում մեթոդի կանչը ապահովելու համար անհրաժեշտ է override անել այս հատկությունը՝ վերադարձնելով true արժեք։

```c#
public virtual bool AlwaysCallBeforeProcess => false; 
```

## Մեթոդներ

### BeforeProcess

Ընդլայնման սյուների արժեքների հաշվարկը ապահովող [ProccessRow](#proccessRow) մեթոդի կանչից առաջ նախապատրաստական գործողությունների կատարման համար անհրաժեշտ է override անել այս մեթոդը։ Հիմնականում օգտագործվում է [ProccessRow](#proccessRow)-ում կիրառվող տվյալների բեռնման և  քեշավորման համար։

```c#
public virtual Task BeforeProcess(IList<IExtendableRow> rows, IDataSourceArgs args)
```

### ProccessRow

Տվյալների աղբյուրի սյուների արժեքների փոփոխման, ընդլայնման սյուների արժեքների լրացման, տողերի ֆիլտրման  համար անհրաժեշտ է override անել այս մեթոդը։ Վերադարձնում է bool տիպի արժեք, որը ցույց է տալիս թե ընթացիկ տողը ընդգրկվի տվյալների աղբյուրի ընդլայնման տողերի վերջնական ցուցակում թե ոչ։ Մեթոդը կանչվում է տվյալների աղբյուրի **յուրաքանչյուր** տողի համար։ 

```c#
public virtual Task<bool> ProccessRow(IExtendableRow row, IDataSourceArgs args)
```

### AddColumn

Ավելացված սյան կառուցվածքը սահմանելու համար անհրաժեշտ է կոնստրուկտորում կանչել այս մեթոդը։

```c#
public void AddColumn(string name, string armenianCaption, string englishCaption, FieldType columnType,
                      string armenianDescription = null, string englishDescription = null,
                      FieldType showType = null, short width = 0, short headlines = 2,
                      SupportedEncoding supportedEncoding = SupportedEncoding.ArmenianAnsi)
```

**Մեթոդի պարամետրերի ցանկ**

* name - սյան ներքին անվանումը,
* armenianCaption - Սյան հայերեն անվանումը՝ անհրաժեշտ է փոխանցել ANSI կոդավորմամբ,
* englishCaption - սյան անգլերեն անվանումը,
* columnType - սյան համակարգային տիպը,
* armenianDescription - սյան հայերեն նկարագրությունը՝ անհրաժեշտ է փոխանցել ANSI կոդավորմամբ,
* englishDescription  - սյան անգլերեն նկարագրությունը,
* showType - Սահմանում է համակարգային տիպը ցուցադրման ժամանակ։ Եթե այս պարամետրը բացակայում է, ապա օգտագործվում է columnType հատկության արժեքը։ Սովորոբար այս հատկությունը օգտագործում են, եթե տվյալների տիպը, որը համապատասխանում է սյունակի արժեքներին, հարմար չի ցուցադրման համար։ Օրինակ եթե columnType = new StringFieldType(150) է, բայց շատ դեպքերում բավական է տեսնել տողի սկիզբը, ապա կարելի է սահմանել showType = new StringFieldType(32),
* width - սյան լայնությունը: Արժեք չփոխանցելու դեպքում որոշվում է կախված սյան armenianCaption, englishCaption, columnType, showType հատկություններից կախված,
* headlines - սյան անվանման մեջ տողերի քանակ։ Լռությամբ արժեքը 2 է,
* supportedEncoding - սյան կոդավորման տեսակը, որը կարող է ընդունել 3  արժեք՝ ArmenianAnsi, RussionAnsi և Unicode։


### AddParam

Ավելացված պարամետրի կառուցվածքը սահմանելու համար անհրաժեշտ է կոնստրուկտորում կանչել այս մեթոդը։

```c#
public void AddParam(string name, string description, FieldType fieldType)
```

**Մեթոդի պարամետրերի ցանկ**

* name - պարամետրի ներքին անվանումը,
* description - պարամետրի հայերեն նկարագրությունը՝ անհրաժեշտ է փոխանցել ANSI կոդավորմամբ
* fieldType - պարամետրի համակարգային տիպը:
