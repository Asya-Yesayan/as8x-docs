---
layout: page
title: "Տվյալների աղբյուրի օգտագործման օրինակներ" 
---

# Տվյալների աղբյուրի օգտագործման օրինակներ

# Տվյալների աղբյուրի server-side կատարումը AS-8X համակարգում

Տվյալների աղբյուրը կարելի է կատարել եղանակներով՝
- Օգտագործելով DataSourceService դասի ExecuteDataSource մեթոդը
- Ստեղծելով տվյալների աղբյուրը նկարագրող դասի օբյեկտ և կանչել այդ դասի Execute մեթոդը

Առաջին եղանակով կատարումը չտիպիզացված տարբերակն է՝ տվյալների աղբյուրի կատարման համար անհրաժեշտ պարամետրերը փոխանցում ենք Dictionary<string, object> դասի օբյեկտի միջոցով։

Երկրորդ եղանակով կատարումը տիպիզացված տարբերակն է՝ տվյալների աղբյուրի կատարման համար անհրաժեշտ պարամետրերը փոխանցում ենք տվյալների աղբյուրի պարամետրերը նկարագրող դասի օբյեկտի միջոցով։

# Չտիպիզացված կատարում

1.  Ստեղծել Dictionary<string, object>() դասի օբյեկտ և փոխանցել տվյալների աղբյուրի կատարման համար անհրաժեշտ պարամետրերը՝ որպես key գրելով պարամետրի անունը, իսկ որպես value` արժեքը:
2.  Կանչել DataSourceService դասի Execute մեթոդը՝ փոխանցելով տվյալների աղբյուրի ներքին անվանումը և պարամետրերի ցանկը:

Արդյունքում ստացվում է տվյալների աղբյուրի տողերի տիպիզացված ցուցակ՝ List&lt;T&gt;` որպես T նշելով տվյալների աղբյուրի սյուները նկարագրող դասը։

Օրինակ՝ 
```c#
var dsParams = new Dictionary<string, object>()
{
            { "Type", "C" },
            { "Date", DateTime.Now },
            { "AgrCondIn", "ModType:5" },
            { "ShowWithoutOutSum", true },
            { "CurDef", Constants.CurAMD },
            { "TurnDateStart", DateTime.Now },
            { "AgrsGroups", "1,2" },
            { "AgrCondLike", "ACSBRANCH:" },
            { "CliCondEqual", "RELBANK:1" }
};
var dsResult = this.dsService.ExecuteDataSource<PAGRINFO>("PAGRINFO", dsParams);
```

# Տիպիզացված կատարում

Երկրորդ տարբերակով իրականացնելու համար անհրաժեշտ է ՝

1.  Ստանալ տվյալների աղբյուրի տիպիզացված նկարագրությունը DataSourceService դասի GetDataSource<T> մեթոդի կանչի միջոցով՝ որպես T փոխանցելով տվյալների աղբյուրը նկարագրող դասը։
2.  Ստեղծել տվյալների աղբյուրի պարամետրերը նկարագրող դասի օբյեկտ՝ պարամետրերին փոխանցելով անհրաժեշտ արժեքները։
3. GetDataSource-ի մեթոդի արդյունքում վերադարձված տվյալների աղբյուրի Execute մեթոդը կանչել՝ փոխանցելով նախապես ստեղծված պարամետրերը նկարագրող դասը։
   
Անհրաժեշտության դեպքում Execute մեթոդում կարելի է նաև նշել՝
- կատարման արդյունքում տվյալների աղբյուրի վերադարձվող սյուների ցուցակը(չլրացնելու դեպքում վերադարձվելու են տվյալների աղբյուրի բոլոր սյուները),
-  տվյալների աղբյուրի ընդլայնումը,
-  CancellationToken-ը:


Արդյունքում ստացվում է DataSourceResult<R> դասի օբյեկտ՝ որպես R նշելով տվյալների աղբյուրի տողերը նկարագրող դասը։
DataSourceResult դասը իր մեջ պարունակում է՝

| Անվանում | Տեսակ | **Նկարագրություն** |
| --- | --- | --- |
| Rows | List<R>| Տվյալների աղբյուրի տողերը |
| Schema | Schema| Տվյալների աղբյուրի սխեման, որը պարունակում է տվյալների աղբյուրի սյուների և պարամետրերի կառուցվածքի մասին ամբողջական ինֆորմացիան |
| Columns | HashSet<string>| Տվյալների աղբյուրի սյուների անվանումների ցուցակը |
| Progress | DataSourceExecutionProgress | Տվյալների աղբյուրի պրոգրեսի մասին ինֆորմացիան |
| ErrorMessage | string | Տվյալների աղբյուրի կատարման ընթացքում առաջացած սխալի հաղորդագրությունը |
| ErrorMessageTitle | string | Տվյալների աղբյուրի կատարման ընթացքում առաջացած սխալի գլխագիրը  |
| ErrorIsRestException | bool | Տվյալների աղբյուրի կատարման ընթացքում առաջացած սխալի հաղորդագրությունը |
| ErrorDetails | List<ErrorDetail> | Տվյալների աղյուրի կատարման ընթացքում առաջացած սխալների մանրամասն նկարագրությունները |
| isRestException | Boolean | Տվյալների աղբյուրի կատարման ընթացքում առաջացած սխալը RESTException (օգտագործողի կողմից՝ առաջացրած, չլոգավորվող սխալ) տեսակի է թե ոչ |
| ErrorRow | R | Այն տողը, որի մշակման ժամանակ տեղի է ունեցել սխալը։ |
| ShowProgress | Boolean | Ցույց տալ տվյալների աղբյուրի կատարման գործընթացի փուլերը թե ոչ |
| Extender | IExtender | Տվյալների աղբյուրի ընդլայնումը |
| FirstFetchSize | Number | Տվյալների աղբյուրի առաջին բլոկի բեռնման տողերի մաքսիմալ քանակ |
| FetchSize | Number | Տվյալների աղբյուրի ամեն բլոկի բեռնման տողերի մաքսիմալ քանակ |
| FetchID | Guid | Տվյալների աղբյուրի կատարման ընթացքին հետևելու, արդյունքը ստանալու ու կատարումը ընդհատելու համար ստեղծված unique id |
| Lifetime | DateTime? | Տվյալների աղբյուրի քեշում պահվելու ժամանակահատվածը |
| EncodeResultUnicode | bool | Տվյալների աղբյուրի տվյալների կոդավորման տեսակը |
| UseRowsBinarySerializer | bool | Տվյալների աղբյուրի տվյալները վերադարձվում են բինար տեսքով թե ոչ |
| LastFetched | int | Տվյալների աղբյուրի տողերի բեռնված վերջին բլոկի համարը |
| AdditionalData | Dictionary<string, object> | Տվյալների աղբյուրի մասին լրացուցիչ տեղեկատվություն |

Օրինակ
```c#
var dsPAGRINFO = this.dsService.GetDataSource<PAGRINFO>();
var dsParams = new PAGRINFO.Param
{
    Type = "C",
    Date = repDate,
    AgrCondIn = "ModType:5",
    ShowWithoutOutSum = true,
    CurDef = Constants.CurAMD,
    TurnDateStart = DateAndTime.DateSerial(repDate.Year, repDate.Month, 1),
    AgrsGroups = "1,2",
    AgrCondLike = "ACSBRANCH:" + branch,
    CliCondEqual = "RELBANK:1"
};

var dsResult = await dsPAGRINFO.Execute(dsParams);
```


