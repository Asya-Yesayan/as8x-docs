---
layout: page
title: "LiteDocumentService" 
tags: [LiteDocumentService, Cache, Document]
---

## Բովանդակություն
- [Բովանդակություն](#բովանդակություն)
- [Ներածություն](#ներածություն)
- [Մեթոդներ](#մեթոդներ)
  - [ClearCache](#clearcache)
  - [Load](#load)
  - [LoadFromFolder](#loadfromfolder)
  - [LoadGrids](#loadgrids)
  - [LoadIntoCache](#loadintocache)
  - [LookUpInCache](#lookupincache)
  - [LookUpInCache](#lookupincache-1)
  - [LookUpInCache](#lookupincache-2)
  - [RemoveFromCache](#removefromcache)
  - [RemoveFromCache](#removefromcache-1)

## Ներածություն

8X սերվիսում կան LiteDocument և RODocument դասեր, որոնք նախատեսված են փաստաթուղթը բեռնելու, քեշում պահելու և կարդալու նպատակով։
Այս տեսակի փաստաթղթերը հնարավորություն չեն տալիս փաստաթղթում կատարել փոփոխություններ և գրանցել տվյալների պահոցում, նախապես են միայն կարդալու ֆունկցիոնալություն ապահովելու համար։
LiteDocumentService դասը նախատեսված է LiteDocument տիպի փաստաթղթերը քեշում պահելու և քեշից կարդալու ֆունկցիոնալությունը ապահովելու համար։

## Մեթոդներ

### ClearCache

```c#
public void ClearCache();
```

Հեռացնում է բոլոր փաստաթղթերը քեշից։

### Load

```c#
public override Task<LiteDocument> Load(int isn,
                                        bool loadGrids = false,
                                        bool throwExceptionIfDeleted = true,
                                        bool lookInArc = true);
```

Բեռնում է փաստաթուղթը տվյալների պահոցից ըստ փաստաթղթի ներքին նույնականացման համարի։

**Պարամետրեր**

* `isn` - Բեռնվող փաստաթղթի ներքին նույնականացման համարը։
* `loadGrids` - Փաստաթղթի աղյուսակների բեռնման հայտանիշ։ Լռությամբ արժեքը **false** է։
* `throwExceptionIfDeleted` - Պահանջվող փաստաթղթի հեռացված լինելու դեպքում սխալի գեներացման հայտանիշ։ Լռությամբ արժեքը **true** է:
* `lookInArc` - Արխիվացված փաստաթղթի բեռնման հայտանիշ։ **true** արժեքի դեպքում փաստաթուղթը հիմնական պահոցում չգտնելու դեպքում փորձում է բեռնել նաև արխիվային տվյալների պահոցից, եթե այնտեղ նույնպես փաստաթութը առկա չէ, առաջանում է սխալ։ Լռությամբ արժեքը **true** է։

### LoadFromFolder

```c#
public Task<LiteDocument> LoadFromFolder(string folderID, string folderKey, bool loadGrids = false);
```

Բեռնում է փաստաթուղթը տվյալների պահոցից ըստ փաստաթուղթը պարունակող թղթապանակի ներքին անվան և թղթապանակի տարրի կոդի։

**Պարամետրեր**

* `folder` - Փաստաթուղթը պարունակող թղթապանակի ներքին անունը։
* `folderKey` - Թղթապանակի տարրի կոդը։
* `loadGrids` - Աղյուսակների բեռնման հայտանիշ։ Լռությամբ արժեքը **false** է։

### LoadGrids

```c#
public Task LoadGrids(LiteDocument document, IDBService dBService, bool lookInArc = false);
```

Բեռնում է փաստաթղթի աղյուսակները տվյալների պահոցից։

**Պարամետրեր**

* `document` - Փաստաթուղթը նկարագրող դասը։
* `dBService` - Տվյալների պահոցի հետ կապ հաստատելու համար նախատեսված [IDBService](DBService.md) դասի օբյեկտ։
* `lookInArc` - Արխիվացված փաստաթղթի աղյուսակների բեռնման հայտանիշ։ **true** արժեքի դեպքում փաստաթուղթը հիմնական պահոցում չգտնելու դեպքում փորձում է աղյուսակները բեռնել նաև արխիվային տվյալների պահոցից, եթե այնտեղ նույնպես փաստաթութը առկա չէ, առաջանում է սխալ։ Լռությամբ արժեքը **true** է։

### LoadIntoCache

```c#
public virtual Task<T> LoadIntoCache(int isn,
                                    bool throwExceptionIfDeleted = true,
                                    Ref<bool> isRefreshed = null,
                                    bool lookInArc = true)
                                    where T : LiteDocument, new();
```

Բեռնում է փաստաթուղթը տվյալների պահոցից ըստ փաստաթղթի ներքին նույնականացման համարի և ավելացնում քեշում։

**Պարամետրեր**

* `isn` - Բեռնվող փաստաթղթի ներքին նույնականացման համարը։
* `throwExceptionIfDeleted` - Պահանջվող փաստաթղթի հեռացված լինելու դեպքում սխալի գեներացման հայտանիշ։ Լռությամբ արժեքը **true** է:
* `isRefreshed` - Ցույց է տալիս, արդյոք մեթոդի կանչի արդյունքում փաստաթուղթը բեռնվել է տվյալների պահոցից և թարմացվել քեշում, թե ոչ։ Լռությամբ արժեքը **null** է:
* `lookInArc` - Արխիվացված փաստաթղթի բեռնման հայտանիշ։ **true** արժեքի դեպքում փաստաթուղթը հիմնական պահոցում չգտնելու դեպքում փորձում է բեռնել նաև արխիվային տվյալների պահոցից, եթե այնտեղ նույնպես փաստաթութը առկա չէ, առաջանում է սխալ։ Լռությամբ արժեքը **true** է։

### LookUpInCache

```c#
public Task<T> LookUpInCache<T>(int isn,
                                bool checkRelevance,
                                DocumentLoadSession session = null,
                                Ref<bool> isRefreshed = null,
                                bool lookInArc = true) where T : LiteDocument, new();
```

Փնտրում է փաստաթուղթը քեշում ըստ փաստաթղթի ներքին նույնականացման համարի և վերադարձնում։ Քեշում բացակայության դեպքում բեռնում է փաստաթուղթը տվյալների պահոցից, ավելացնում քեշում և վերադարձնում։

**Պարամետրեր**

* `isn` - Փնտրվող փաստաթղթի ներքին նույնականացման համարը։
* `checkRelevance` - Քեշում պարունակվող փաստաթղթի թարմության ստուգման հայտանիշ։ **true** արժեքի դեպքում եթե քեշում պարունակվող փաստաթղթի timestamp-ը չի համընկնում տվյալների պահոցում գրանցված timestamp-ի հետ կամ **session**-ի արդյունքում չի ստուգվել փաստաթղթի թարմությունը, ապա փաստաթուղթը բեռնում է տվյալների պահոցից, հակառակ դեպքում վերադարձնում է քեշում առկա փաստաթուղթը։
* `session` - Փաստաթղթի բեռնման սեսսիա։ Սեսսիայով քեշում պարունակվող փաստաթուղթը բեռնելիս առաջին անգամ ստուգվում է փաստաթղթի թարմությունը և եթե քեշում պարունակվող փաստաթղթի timestamp-ը չի համընկնում տվյալների պահոցում գրանցված timestamp-ի հետ, ապա փաստաթուղթը բեռնում է տվյալների պահոցից, հակառակ դեպքում բեռնում քեշից, ավելացնում սեսսիայում և մնացած անգամները դիմելուց վերադարձնում է սեսսիայում առկա փաստաթուղթը։ 
* `isRefreshed` - Ցույց է տալիս, արդյոք մեթոդի կանչի արդյունքում փաստաթուղթը բեռնվել է տվյալների պահոցից և թարմացվել քեշում, թե ոչ։ Լռությամբ արժեքը **null** է:
* `lookInArc` - Արխիվացված փաստաթղթի բեռնման հայտանիշ։ **true** արժեքի դեպքում փաստաթուղթը հիմնական պահոցում չգտնելու դեպքում փորձում է բեռնել նաև արխիվային տվյալների պահոցից, եթե այնտեղ նույնպես փաստաթութը առկա չէ, առաջանում է սխալ։ Լռությամբ արժեքը **true** է։

### LookUpInCache

```c#
public Task<T> LookUpInCache(int isn,
                             TimeSpan checkAfter,
                             Ref<bool> isRefreshed = null,
                             bool lookInArc = true)
                             where T : LiteDocument, new();
```

Փնտրում է փաստաթուղթը քեշում ըստ փաստաթղթի ներքին նույնականացման համարի և վերադարձնում։ Քեշում բացակայության դեպքում բեռնում է փաստաթուղթը տվյալների պահոցից, ավելացնում քեշում և վերադարձնում։ 

**Պարամետրեր**

* `isn` - Փնտրվող փաստաթղթի ներքին նույնականացման համարը։
* `checkAfter` - Քեշում պարունակվող փաստաթղթի թարմության վերջին ստուգումից հետո անցած ժամանակահատված, որի ավարտից հետո անհրաժեշտ է կրկին ստուգել փաստաթղթի թարմությունը։ Եթե քեշում պարունակվող փաստաթղթի timestamp-ը չի համընկնում տվյալների պահոցում գրանցված timestamp-ի հետ, ապա փաստաթուղթը բեռնում է տվյալների պահոցից, հակառակ դեպքում վերադարձնում է քեշում առկա փաստաթուղթը։  
* `isRefreshed` - Ցույց է տալիս, արդյոք մեթոդի կանչի արդյունքում փաստաթուղթը բեռնվել է տվյալների պահոցից և թարմացվել քեշում, թե ոչ։ Լռությամբ արժեքը **null** է:
* `lookInArc` - Արխիվացված փաստաթղթի բեռնման հայտանիշ։ **true** արժեքի դեպքում փաստաթուղթը հիմնական պահոցում չգտնելու դեպքում փորձում է բեռնել նաև արխիվային տվյալների պահոցից, եթե այնտեղ նույնպես փաստաթութը առկա չէ, առաջանում է սխալ։ Լռությամբ արժեքը **true** է։

### LookUpInCache

```c#
public Task<T> LookUpInCache(string folderID,
                             string folderKey,
                             TimeSpan checkAfter,
                             Ref<bool> isRefreshed = null) where T : LiteDocument, new();
```

Փնտրում է փաստաթուղթը քեշում ըստ փաստաթուղթը պարունակող թղթապանակի ներքին անվան և թղթապանակի տարրի կոդի և վերադարձնում։ Քեշում բացակայության դեպքում բեռնում է փաստաթուղթը տվյալների պահոցից, ավելացնում քեշում և վերադարձնում։ 

**Պարամետրեր**

* `folderID` - Փաստաթուղթը պարունակող թղթապանակի ներքին անունը։
* `folderKey` - Թղթապանակի տարրի կոդը։
* `checkAfter` - Քեշում պարունակվող փաստաթղթի թարմության վերջին ստուգումից հետո անցած ժամանակահատված, որի ավարտից հետո անհրաժեշտ է կրկին ստուգել փաստաթղթի թարմությունը։ Եթե քեշում պարունակվող փաստաթղթի timestamp-ը չի համընկնում տվյալների պահոցում գրանցված timestamp-ի հետ, ապա փաստաթուղթը բեռնում է տվյալների պահոցից, հակառակ դեպքում վերադարձնում է քեշում առկա փաստաթուղթը։ 
* `isRefreshed` - Ցույց է տալիս, արդյոք մեթոդի կանչի արդյունքում փաստաթուղթը բեռնվել է տվյալների պահոցից և թարմացվել քեշում, թե ոչ։ Լռությամբ արժեքը **null** է:

### RemoveFromCache

```c#
public void RemoveFromCache(int isn);
```

Հեռացնում է փաստաթուղթը քեշից։

**Պարամետրեր**

* `isn` - Փաստաթղթի ներքին նույնականացման համարը։

### RemoveFromCache

```c#
public void RemoveFromCache(string docType);
```

Հեռացնում է նշված տեսակի բոլոր փաստաթղթերը քեշից։

**Պարամետրեր**

* `docType` - Փաստաթղթի տեսակը։
