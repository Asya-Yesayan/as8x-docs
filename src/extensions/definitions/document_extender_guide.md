---
layout: page
title: "Փաստաթղթի ընդլայնման ձեռնարկ" 
---

# Փաստաթղթի ընդլայնման ձեռնարկ



## Բովանդակություն
* [Ներածություն](#Ներածություն)
* [cs ֆայլի ստեղծում](#cs-ֆայլի-ստեղծում)
* [as ֆայլի ստեղծում](#as-ֆայլի-ստեղծում)
* [Ֆայլերի ներմուծում SYSCON ծրագրի միջոցով](#Ֆայլերի-ներմուծում-SYSCON-ծրագրի-միջոցով)

## Ներածություն

8X համակարգում նախատեսված է հնարավորություն ընդլայնելու համակարգում առկա փաստաթղթերի մշակման գործընթացը ավելացնելով լրացուցիչ ստուգումներ, իրականացնելով դաշտերի ավտոմատ լրացում, ինչպես նաև կատարելով ցանկացած այլ գործողություններ, որոնք պետք է կատարվեն փաստաթղթի ստեղծման, խմբագրման կամ հեռացման ընթացքում։

Փաստաթղթերի ընդլայնման համար անհչաժեշտ է ստեղծել երկու ֆայլ՝ ընդլայնման c# դասերը պարունակող ```.cs``` ընդլայնումով ֆայլը և ուղեկցող ```.as``` ֆայլը, որը պետք է պարունակի ներմուծվող DOCUMENTEXTENDER -ի մետատվյալները։ Ընդլայնման ֆայլերի ինչպես նաև DocumentExtender դասի նկարագրությունը հասանելի է [Փաստաթղթի ընդլայնման նկարագրություն](document_extender.md) բաժնում։

## cs ֆայլի ստեղծում

Ֆայլում պարունակվող դասը ժառանգում է [DocumentExtender](document_extender.md) դասը, և կարող է ընդլայնել դասում նկարագրված մեթոդները։ 

Մեթոդները, որպես պարամետր (Document sender) ստանում են մշակվող փաստաթղթի օբյեկտը, որի միջոցով հնարավոր է մշակման տարբեր փուլերում կատարել լրացված դաշտերի ստուգում, ավտոմատ լրացում, առաջացնել բացառություններ (exceptions) ընդհատելով փաստաթղթի մշակումը, ինչպես նաև կատարել ցանկացած այլ գործողություն։ 

Մեթոդներում հնարավոր է կատարել նաև ասինխրոն գործողություններ, այդ դեպքում անհրաժեշտ է մեթոդը հայտարարել որպես async:

Անհրաժեշտույան դեպքում դասում կարող է սահմանված լինել կոնստրուկտոր, որի միջոցով հնարավոր է ինյեկցիայի միջոցով 
փոխանցել լրացուցիչ 8x սերվիսներ, որոնց օգտագործումը անհրաժեշտ է ընդլայնվող մեթոդներում։

```c#
namespace DocExtensions;

[DocumentExtender]
public class MyDocExtension : DocumentExtender
{
    private readonly IParametersService paramService;
     
    public MyDocExtension(IParametersService paramService)
    {
        this.paramService = paramService;
    }
    public override Task PostAction(Document sender, ActionEventArgs args)
    {

    }

    public async override Task PreValidate(Document sender, ValidateEventArgs args)
    {
        
    }
    
    public override Task PostAction(Document sender, ActionEventArgs args)
    {

    }
}
```

## as ֆայլի ստեղծում

```.as``` ֆայլը պարունակում է տվյալներ ընդլայնվող փաստաթղթի և ներմուծվող ընդլայնման վերաբերյալ։ 

```NAME``` պարամետրով սահմանվում է ընդլայնվող փաստաթղթի ներքին անվանումը։ 

```CAPTION``` և ```ECAPTION```  պարամետրով սահմանվում է ՀԾ-Բանկ համակարգում արտացոլվող ընդլայնման հայերեն և անգլերեն անվանումները (հայերեն անվանումը սահմանվում է ANSI կոդավորմամբ)։ 

```CSSOURCE``` -ով սահմանվում է ներմուծվող ```.cs``` ֆայլի անվանումը։ Այն դեպքում երբ ներմուծելիս ```.as``` և ```.cs``` ֆայլերը գտնվում են նույն պանակի մեջ սահմանվում է միայն ```.cs``` ֆայլի անվանումը։

```
DOCUMENTEXTENDER {
  NAME = "COUNTRY";
  CAPTION = "Երկիր փաստ. ընդլայնում";
  CAPTION = "Country doc extension";
  CSSOURCE = ="CountryEx.cs";
};
```

եթե c# դասը պարունակող ֆայլը գտնվում է այլ պանակում, սահմանվում է   
ամբողջական կամ հարաբերական ճանապահը՝

```
  CSSOURCE = ="..\..\CsFiles\CountryEx.cs";
կամ
  CSSOURCE = ="C:\CsFiles\CountryEx.cs";

```

## Ֆայլերի ներմուծում SYSCON ծրագրի միջոցով

Ֆայլերի ներմուծումը հնարավոր է կատարել SYSCON, Script Editor կամ Visual Studio ծրագրերի միջոցով։ Ստորև նկարագրվում է SYSCON ծրագրի միջոցով ներմուծումը։

```.as``` ֆայլը ներմուծելիս կներմուծվի նաև ֆայլում սահմանված ճանապարհով գտնվող ```.cs``` ֆայլը։

Նախքան Ներմուծումը տեղադրեք ```.as``` ֆայլը config.as ֆայլում սահմանված BASEFOLDER պարամետրով ճանապարհով, այնուհետև գործարկելով SYSCON ծրագիրը ներմուծեք "Նկարագրությունների ներմուծում" հանգույցի ներքո արտացոլվող ֆայլը։

```.cs``` ֆայլը այլ պլանակում տեղադրված լինելու դեպքում ```.as``` ֆայլի ```CSSOURCE``` ապարմերը պետք է պարունակի ամբողջական կամ հարաբերական ճանապարհը դեպի  ```.cs```  ֆայլը, ինչպես նկարագրված է [as ֆայլի ստեղծում](#as-ֆայլի-ստեղծում), հակառակ դեպքում այն նույնպես պետք է հասանելի լինի BASEFOLDER պարամետրով նկարագրված ճանապարհով։

## Փաստաթղթի ընդլայնման օրինակ

Փաստաթղի ընդլայնման օրինակի համար տես՝ Երկիր փաստաթղթի ընդլայնում։
